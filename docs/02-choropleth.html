<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Map Neighborhoods | Intro to Spatial Analysis in R for Health</title>
  <meta name="description" content="This was developed by the Healthy Regions and Policies Lab." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Map Neighborhoods | Intro to Spatial Analysis in R for Health" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This was developed by the Healthy Regions and Policies Lab." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Map Neighborhoods | Intro to Spatial Analysis in R for Health" />
  
  <meta name="twitter:description" content="This was developed by the Healthy Regions and Policies Lab." />
  



<meta name="date" content="2025-06-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="01-intro.html"/>
<link rel="next" href="03-overlaypoints.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/Leaflet.glify-3.2.0/addGlifyPoints.js"></script>
<script src="libs/Leaflet.glify-3.2.0/addGlifyPolygons.js"></script>
<script src="libs/Leaflet.glify-3.2.0/addGlifyPolylines.js"></script>
<script src="libs/Leaflet.glify-3.2.0/glify-browser.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Background</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#commitment"><i class="fa fa-check"></i>Commitment</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#access-resources"><i class="fa fa-check"></i>Access Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#environment-setup"><i class="fa fa-check"></i>Environment Setup</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="01-intro.html"><a href="01-intro.html"><i class="fa fa-check"></i><b>1</b> Intro to Spatial Data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="01-intro.html"><a href="01-intro.html#load-spatial-data"><i class="fa fa-check"></i><b>1.1</b> Load Spatial Data</a></li>
<li class="chapter" data-level="1.2" data-path="01-intro.html"><a href="01-intro.html#non-spatial-spatial-views"><i class="fa fa-check"></i><b>1.2</b> Non-Spatial &amp; Spatial Views</a></li>
<li class="chapter" data-level="1.3" data-path="01-intro.html"><a href="01-intro.html#spatial-data-structure"><i class="fa fa-check"></i><b>1.3</b> Spatial Data Structure</a></li>
<li class="chapter" data-level="1.4" data-path="01-intro.html"><a href="01-intro.html#exploring-coordinate-reference-systems"><i class="fa fa-check"></i><b>1.4</b> Exploring Coordinate Reference Systems</a></li>
<li class="chapter" data-level="1.5" data-path="01-intro.html"><a href="01-intro.html#refine-basic-map"><i class="fa fa-check"></i><b>1.5</b> Refine Basic Map</a></li>
<li class="chapter" data-level="1.6" data-path="01-intro.html"><a href="01-intro.html#arrange-multiple-maps"><i class="fa fa-check"></i><b>1.6</b> Arrange multiple maps</a></li>
<li class="chapter" data-level="1.7" data-path="01-intro.html"><a href="01-intro.html#interactive-mode"><i class="fa fa-check"></i><b>1.7</b> Interactive Mode</a></li>
<li class="chapter" data-level="1.8" data-path="01-intro.html"><a href="01-intro.html#overlay-zip-code-boundaries"><i class="fa fa-check"></i><b>1.8</b> Overlay Zip Code Boundaries</a></li>
<li class="chapter" data-level="" data-path="01-intro.html"><a href="01-intro.html#practice-in-sweden"><i class="fa fa-check"></i>Practice in Sweden</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="01-intro.html"><a href="01-intro.html#open-data"><i class="fa fa-check"></i><b>1.8.1</b> Open Data</a></li>
<li class="chapter" data-level="1.8.2" data-path="01-intro.html"><a href="01-intro.html#inspect-data"><i class="fa fa-check"></i><b>1.8.2</b> Inspect Data</a></li>
<li class="chapter" data-level="1.8.3" data-path="01-intro.html"><a href="01-intro.html#crs-check"><i class="fa fa-check"></i><b>1.8.3</b> CRS Check</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="01-intro.html"><a href="01-intro.html#more-resources"><i class="fa fa-check"></i>More Resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02-choropleth.html"><a href="02-choropleth.html"><i class="fa fa-check"></i><b>2</b> Map Neighborhoods</a>
<ul>
<li class="chapter" data-level="2.1" data-path="02-choropleth.html"><a href="02-choropleth.html#clean-attribute-data"><i class="fa fa-check"></i><b>2.1</b> Clean Attribute Data</a></li>
<li class="chapter" data-level="2.2" data-path="02-choropleth.html"><a href="02-choropleth.html#merge-spatial-data"><i class="fa fa-check"></i><b>2.2</b> Merge Spatial Data</a></li>
<li class="chapter" data-level="2.3" data-path="02-choropleth.html"><a href="02-choropleth.html#quantile-maps"><i class="fa fa-check"></i><b>2.3</b> Quantile Maps</a></li>
<li class="chapter" data-level="2.4" data-path="02-choropleth.html"><a href="02-choropleth.html#standard-deviation-maps"><i class="fa fa-check"></i><b>2.4</b> Standard Deviation Maps</a></li>
<li class="chapter" data-level="2.5" data-path="02-choropleth.html"><a href="02-choropleth.html#jenks-maps"><i class="fa fa-check"></i><b>2.5</b> Jenks Maps</a></li>
<li class="chapter" data-level="2.6" data-path="02-choropleth.html"><a href="02-choropleth.html#integrate-more-data"><i class="fa fa-check"></i><b>2.6</b> Integrate More Data</a></li>
<li class="chapter" data-level="2.7" data-path="02-choropleth.html"><a href="02-choropleth.html#thematic-map-panel"><i class="fa fa-check"></i><b>2.7</b> Thematic Map Panel</a></li>
<li class="chapter" data-level="2.8" data-path="02-choropleth.html"><a href="02-choropleth.html#data"><i class="fa fa-check"></i><b>2.8</b> Data</a></li>
<li class="chapter" data-level="" data-path="02-choropleth.html"><a href="02-choropleth.html#more-resources-1"><i class="fa fa-check"></i>More Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html"><i class="fa fa-check"></i><b>3</b> Adding Resources</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#geocode"><i class="fa fa-check"></i><b>3.1</b> Geocode</a></li>
<li class="chapter" data-level="3.2" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#convert-to-spatial-data"><i class="fa fa-check"></i><b>3.2</b> Convert to Spatial Data</a></li>
<li class="chapter" data-level="3.3" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#basic-map-of-points"><i class="fa fa-check"></i><b>3.3</b> Basic Map of Points</a></li>
<li class="chapter" data-level="3.4" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#overlay-points-style"><i class="fa fa-check"></i><b>3.4</b> Overlay Points &amp; Style</a></li>
<li class="chapter" data-level="3.5" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#integrate-more-data-1"><i class="fa fa-check"></i><b>3.5</b> Integrate More Data</a></li>
<li class="chapter" data-level="3.6" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#graduated-symbology"><i class="fa fa-check"></i><b>3.6</b> Graduated Symbology</a></li>
<li class="chapter" data-level="3.7" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#style-final-map"><i class="fa fa-check"></i><b>3.7</b> Style Final Map</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-newsvar.html"><a href="04-newsvar.html"><i class="fa fa-check"></i><b>4</b> Calculate Spatial Metrics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-newsvar.html"><a href="04-newsvar.html#load-spatial-data-1"><i class="fa fa-check"></i><b>4.1</b> Load Spatial Data</a></li>
<li class="chapter" data-level="4.2" data-path="04-newsvar.html"><a href="04-newsvar.html#transform-projections"><i class="fa fa-check"></i><b>4.2</b> Transform Projections</a></li>
<li class="chapter" data-level="4.3" data-path="04-newsvar.html"><a href="04-newsvar.html#count-resources-by-area"><i class="fa fa-check"></i><b>4.3</b> Count resources by area</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="04-newsvar.html"><a href="04-newsvar.html#count-per-area"><i class="fa fa-check"></i><b>4.3.1</b> Count # per Area</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="04-newsvar.html"><a href="04-newsvar.html#buffer-data"><i class="fa fa-check"></i><b>4.4</b> Buffer Data</a></li>
<li class="chapter" data-level="4.5" data-path="04-newsvar.html"><a href="04-newsvar.html#count-buffers-by-area"><i class="fa fa-check"></i><b>4.5</b> Count buffers by area</a></li>
<li class="chapter" data-level="4.6" data-path="04-newsvar.html"><a href="04-newsvar.html#integrate-explore"><i class="fa fa-check"></i><b>4.6</b> Integrate &amp; Explore</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to Spatial Analysis in R for Health</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="map-neighborhoods" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Map Neighborhoods<a href="02-choropleth.html#map-neighborhoods" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>When considering the health of persons, we have to also consider the neighborhood environment. Sometimes this is looking at neighborhood level health outcomes, like premature mortality at the census tract scale, or cumulative COVID rates by zip code. Sometimes we’re interested in neighborhood factors like poverty, access to affordable housing, or distance to nearest health provider, or pollution-emitting facility. These measurements of the “social determinants of health” at the neighborhood scale are increasingly urgent in modern public health thinking, and are thought to drive and/or reinforce racial, social, and spatial inequity</p>
<p>In this module, we’ll learn about the basics of thematic mapping – known as <em>choropleth mapping</em> – to visualize neighborhood level health phenomena. This will allow you to begin the process of exploratory spatial data analysis and hypothesis generation &amp; refinement.</p>
<div id="clean-attribute-data" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Clean Attribute Data<a href="02-choropleth.html#clean-attribute-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s consider COVID-19 cases by zip code in Chicago. We’ll upload and inspect a summary of cases from the <em>Chicago Data Portal</em> first:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="02-choropleth.html#cb43-1" tabindex="-1"></a>COVID <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/COVID-19_Cases__Tests__and_Deaths_by_ZIP_Code.csv&quot;</span>)</span>
<span id="cb43-2"><a href="02-choropleth.html#cb43-2" tabindex="-1"></a></span>
<span id="cb43-3"><a href="02-choropleth.html#cb43-3" tabindex="-1"></a><span class="fu">head</span>(COVID)</span></code></pre></div>
<pre><code>##   ZIP.Code Week.Number Week.Start   Week.End Cases...Weekly Cases...Cumulative Case.Rate...Weekly
## 1    60603          39 09/20/2020 09/26/2020              0                 13                  0
## 2    60604          39 09/20/2020 09/26/2020              0                 31                  0
## 3    60611          16 04/12/2020 04/18/2020              8                 72                 25
## 4    60611          15 04/05/2020 04/11/2020              7                 64                 22
## 5    60615          11 03/08/2020 03/14/2020             NA                 NA                 NA
## 6    60603          10 03/01/2020 03/07/2020             NA                 NA                 NA
##   Case.Rate...Cumulative Tests...Weekly Tests...Cumulative Test.Rate...Weekly Test.Rate...Cumulative
## 1                 1107.3             25                327               2130                27853.5
## 2                 3964.2             12                339               1534                43350.4
## 3                  222.0            101                450                312                 1387.8
## 4                  197.4             59                349                182                 1076.3
## 5                     NA              6                  9                 14                   21.7
## 6                     NA              0                  0                  0                    0.0
##   Percent.Tested.Positive...Weekly Percent.Tested.Positive...Cumulative Deaths...Weekly
## 1                              0.0                                  0.0               0
## 2                              0.0                                  0.1               0
## 3                              0.1                                  0.2               0
## 4                              0.1                                  0.2               0
## 5                               NA                                   NA               0
## 6                               NA                                   NA               0
##   Deaths...Cumulative Death.Rate...Weekly Death.Rate...Cumulative Population   Row.ID
## 1                   0                   0                       0       1174 60603-39
## 2                   0                   0                       0        782 60604-39
## 3                   0                   0                       0      32426 60611-16
## 4                   0                   0                       0      32426 60611-15
## 5                   0                   0                       0      41563 60615-11
## 6                   0                   0                       0       1174 60603-10
##              ZIP.Code.Location
## 1 POINT (-87.625473 41.880112)
## 2 POINT (-87.629029 41.878153)
## 3 POINT (-87.620291 41.894734)
## 4 POINT (-87.620291 41.894734)
## 5 POINT (-87.602725 41.801993)
## 6 POINT (-87.625473 41.880112)</code></pre>
<p>Each row corresponds to a zip code at a different week. This data thus exists as a “long” format, which doesn’t work for spatial analysis. We need to convert to “wide” format, or at the very least, ensure that each zip code corresponds to one row.</p>
<p>To simplify, let’s identify the last week of the dataset, and then subset the data frame to only show that week. We will be interested in the cumulative case rate. Following is one way of doing this – can you think of another way? Try out different approaches of reshaping data to test your R and “tidy” skills.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="02-choropleth.html#cb45-1" tabindex="-1"></a><span class="do">## How many weeks are in our dataset?</span></span>
<span id="cb45-2"><a href="02-choropleth.html#cb45-2" tabindex="-1"></a><span class="fu">range</span>(<span class="fu">as.numeric</span>(COVID<span class="sc">$</span>Week.Number))</span></code></pre></div>
<pre><code>## [1] 10 40</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="02-choropleth.html#cb47-1" tabindex="-1"></a><span class="do">## Subset &amp; inspect to week 39.</span></span>
<span id="cb47-2"><a href="02-choropleth.html#cb47-2" tabindex="-1"></a>COVID<span class="fl">.39</span> <span class="ot">&lt;-</span> <span class="fu">subset</span>(COVID, COVID<span class="sc">$</span>Week.Number <span class="sc">==</span> <span class="st">&quot;39&quot;</span>)</span>
<span id="cb47-3"><a href="02-choropleth.html#cb47-3" tabindex="-1"></a><span class="fu">head</span>(COVID<span class="fl">.39</span>)</span></code></pre></div>
<pre><code>##    ZIP.Code Week.Number Week.Start   Week.End Cases...Weekly Cases...Cumulative Case.Rate...Weekly
## 1     60603          39 09/20/2020 09/26/2020              0                 13                  0
## 2     60604          39 09/20/2020 09/26/2020              0                 31                  0
## 36    60601          39 09/20/2020 09/26/2020              8                213                 54
## 37    60602          39 09/20/2020 09/26/2020              0                 21                  0
## 41    60605          39 09/20/2020 09/26/2020             12                391                 44
## 66    60610          39 09/20/2020 09/26/2020             35                666                 90
##    Case.Rate...Cumulative Tests...Weekly Tests...Cumulative Test.Rate...Weekly Test.Rate...Cumulative
## 1                  1107.3             25                327               2130                27853.5
## 2                  3964.2             12                339               1534                43350.4
## 36                 1451.4            202               4304               1376                29328.8
## 37                 1688.1             27                460               2170                36977.5
## 41                 1420.8            291               7160               1058                26018.4
## 66                 1706.9            500              10680               1281                27371.3
##    Percent.Tested.Positive...Weekly Percent.Tested.Positive...Cumulative Deaths...Weekly
## 1                               0.0                                  0.0               0
## 2                               0.0                                  0.1               0
## 36                              0.0                                  0.0               1
## 37                              0.0                                  0.0               0
## 41                              0.0                                  0.1               1
## 66                              0.1                                  0.1               0
##    Deaths...Cumulative Death.Rate...Weekly Death.Rate...Cumulative Population   Row.ID
## 1                    0                 0.0                     0.0       1174 60603-39
## 2                    0                 0.0                     0.0        782 60604-39
## 36                   6                 6.8                    40.9      14675 60601-39
## 37                   0                 0.0                     0.0       1244 60602-39
## 41                   3                 3.6                    10.9      27519 60605-39
## 66                  10                 0.0                    25.6      39019 60610-39
##               ZIP.Code.Location
## 1  POINT (-87.625473 41.880112)
## 2  POINT (-87.629029 41.878153)
## 36 POINT (-87.622844 41.886262)
## 37 POINT (-87.628309 41.883136)
## 41 POINT (-87.623449 41.867824)
## 66   POINT (-87.63581 41.90455)</code></pre>
<p>To clean our data a bit, we’ll just keep the zip code name, and cumulative case rate for the week of September 20th, 2020.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="02-choropleth.html#cb49-1" tabindex="-1"></a>COVID<span class="fl">.39</span>f <span class="ot">&lt;-</span> COVID<span class="fl">.39</span>[,<span class="fu">c</span>(<span class="st">&quot;ZIP.Code&quot;</span>, <span class="st">&quot;Case.Rate...Cumulative&quot;</span>)]</span>
<span id="cb49-2"><a href="02-choropleth.html#cb49-2" tabindex="-1"></a></span>
<span id="cb49-3"><a href="02-choropleth.html#cb49-3" tabindex="-1"></a><span class="fu">head</span>(COVID<span class="fl">.39</span>f)</span></code></pre></div>
<pre><code>##    ZIP.Code Case.Rate...Cumulative
## 1     60603                 1107.3
## 2     60604                 3964.2
## 36    60601                 1451.4
## 37    60602                 1688.1
## 41    60605                 1420.8
## 66    60610                 1706.9</code></pre>
</div>
<div id="merge-spatial-data" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Merge Spatial Data<a href="02-choropleth.html#merge-spatial-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next, let’s merge this data to our zip code master spatial file. Reload if necessary:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="02-choropleth.html#cb51-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb51-2"><a href="02-choropleth.html#cb51-2" tabindex="-1"></a></span>
<span id="cb51-3"><a href="02-choropleth.html#cb51-3" tabindex="-1"></a>Chi_Zips <span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">&quot;data/geo_export_54bc15d8-5ef5-40e4-8f72-bb0c6dbac9a5.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `geo_export_54bc15d8-5ef5-40e4-8f72-bb0c6dbac9a5&#39; from data source 
##   `/Users/maryniakolak/Code/Spatial-Health-Workshop/data/geo_export_54bc15d8-5ef5-40e4-8f72-bb0c6dbac9a5.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 61 features and 4 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -87.94011 ymin: 41.64454 xmax: -87.52414 ymax: 42.02304
## Geodetic CRS:  WGS84(DD)</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="02-choropleth.html#cb53-1" tabindex="-1"></a><span class="fu">head</span>(Chi_Zips)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 4 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -87.80649 ymin: 41.88747 xmax: -87.59852 ymax: 41.93228
## Geodetic CRS:  WGS84(DD)
##   objectid shape_area shape_len   zip                       geometry
## 1       33  106052287  42720.04 60647 MULTIPOLYGON (((-87.67762 4...
## 2       34  127476051  48103.78 60639 MULTIPOLYGON (((-87.72683 4...
## 3       35   45069038  27288.61 60707 MULTIPOLYGON (((-87.785 41....
## 4       36   70853834  42527.99 60622 MULTIPOLYGON (((-87.66707 4...
## 5       37   99039621  47970.14 60651 MULTIPOLYGON (((-87.70656 4...
## 6       38   23506056  34689.35 60611 MULTIPOLYGON (((-87.61401 4...</code></pre>
<p>Next, merge on zip code ID. The key in the Chi_Zips object is <code>zip</code>, whereas the key for the COVID data is <code>ZIP.code</code>. Always merge non-spatial <em>to</em> spatial data, not the other way around. Think of the spatial file as your master file that you will continue to add on to…</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="02-choropleth.html#cb55-1" tabindex="-1"></a>Chi_Zipsf <span class="ot">&lt;-</span> <span class="fu">merge</span>(Chi_Zips, COVID<span class="fl">.39</span>f, <span class="at">by.x =</span> <span class="st">&quot;zip&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;ZIP.Code&quot;</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-2"><a href="02-choropleth.html#cb55-2" tabindex="-1"></a></span>
<span id="cb55-3"><a href="02-choropleth.html#cb55-3" tabindex="-1"></a><span class="fu">head</span>(Chi_Zipsf)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 5 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -87.63999 ymin: 41.85317 xmax: -87.60246 ymax: 41.88913
## Geodetic CRS:  WGS84(DD)
##     zip objectid shape_area shape_len Case.Rate...Cumulative                       geometry
## 1 60601       27    9166246  19804.58                 1451.4 MULTIPOLYGON (((-87.62271 4...
## 2 60602       26    4847125  14448.17                 1688.1 MULTIPOLYGON (((-87.60997 4...
## 3 60603       19    4560229  13672.68                 1107.3 MULTIPOLYGON (((-87.61633 4...
## 4 60604       48    4294902  12245.81                 3964.2 MULTIPOLYGON (((-87.63376 4...
## 5 60605       20   36301276  37973.35                 1420.8 MULTIPOLYGON (((-87.62064 4...
## 6 60606       31    6766411  12040.44                 2289.6 MULTIPOLYGON (((-87.63397 4...</code></pre>
</div>
<div id="quantile-maps" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Quantile Maps<a href="02-choropleth.html#quantile-maps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Starting with a “classic epi” approach, let’s look at case rates as quantiles. We use the <code>tmap</code> library, and update the choropleth data classification using the <code>style</code> parameter. We use the Blue-Purple palette, or <code>BuPu</code>, from Colorbrewer.</p>
<p><strong>Colorbrewer Tip:</strong> To display all Colorbrewer palette options, load the <code>RColorBrewer</code> library and run <code>display.brewer.all()</code> – or just Google “R Colorbrewer palettes.”</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="02-choropleth.html#cb57-1" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb57-2"><a href="02-choropleth.html#cb57-2" tabindex="-1"></a></span>
<span id="cb57-3"><a href="02-choropleth.html#cb57-3" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb57-4"><a href="02-choropleth.html#cb57-4" tabindex="-1"></a></span>
<span id="cb57-5"><a href="02-choropleth.html#cb57-5" tabindex="-1"></a><span class="fu">tm_shape</span>(Chi_Zipsf ) <span class="sc">+</span></span>
<span id="cb57-6"><a href="02-choropleth.html#cb57-6" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">&quot;Case.Rate...Cumulative&quot;</span>, </span>
<span id="cb57-7"><a href="02-choropleth.html#cb57-7" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;quantile&quot;</span>, <span class="at">pal=</span><span class="st">&quot;BuPu&quot;</span>,</span>
<span id="cb57-8"><a href="02-choropleth.html#cb57-8" tabindex="-1"></a>              <span class="at">title =</span> <span class="st">&quot;COVID Case Rate&quot;</span>) </span></code></pre></div>
<p><img src="Spatial-R-for-Healthy-Places_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Let’s try tertiles:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="02-choropleth.html#cb58-1" tabindex="-1"></a><span class="fu">tm_shape</span>(Chi_Zipsf ) <span class="sc">+</span></span>
<span id="cb58-2"><a href="02-choropleth.html#cb58-2" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">&quot;Case.Rate...Cumulative&quot;</span>, </span>
<span id="cb58-3"><a href="02-choropleth.html#cb58-3" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;quantile&quot;</span>, <span class="at">n=</span><span class="dv">3</span>, <span class="at">pal=</span><span class="st">&quot;BuPu&quot;</span>,</span>
<span id="cb58-4"><a href="02-choropleth.html#cb58-4" tabindex="-1"></a>              <span class="at">title =</span> <span class="st">&quot;COVID Case Rate&quot;</span>) </span></code></pre></div>
<p><img src="Spatial-R-for-Healthy-Places_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="standard-deviation-maps" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Standard Deviation Maps<a href="02-choropleth.html#standard-deviation-maps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While quantiles are a nice start, let’s classify using a standard deviation map. Standard deviation is a statistical technique type of map based on how much the data differs from the mean.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="02-choropleth.html#cb59-1" tabindex="-1"></a><span class="fu">tm_shape</span>(Chi_Zipsf ) <span class="sc">+</span></span>
<span id="cb59-2"><a href="02-choropleth.html#cb59-2" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">&quot;Case.Rate...Cumulative&quot;</span>, </span>
<span id="cb59-3"><a href="02-choropleth.html#cb59-3" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;sd&quot;</span>, <span class="at">pal=</span><span class="st">&quot;BuPu&quot;</span>,</span>
<span id="cb59-4"><a href="02-choropleth.html#cb59-4" tabindex="-1"></a>              <span class="at">title =</span> <span class="st">&quot;COVID Case Rate&quot;</span>) </span></code></pre></div>
<p><img src="Spatial-R-for-Healthy-Places_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="jenks-maps" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Jenks Maps<a href="02-choropleth.html#jenks-maps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another approach of data classification is natural breaks, or jenks. This approach looks for “natural breaks” in the data using a univariate clustering algorithm.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="02-choropleth.html#cb60-1" tabindex="-1"></a><span class="fu">tm_shape</span>(Chi_Zipsf ) <span class="sc">+</span></span>
<span id="cb60-2"><a href="02-choropleth.html#cb60-2" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">&quot;Case.Rate...Cumulative&quot;</span>, </span>
<span id="cb60-3"><a href="02-choropleth.html#cb60-3" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>, <span class="at">pal=</span><span class="st">&quot;BuPu&quot;</span>,</span>
<span id="cb60-4"><a href="02-choropleth.html#cb60-4" tabindex="-1"></a>              <span class="at">title =</span> <span class="st">&quot;COVID Case Rate&quot;</span>) </span></code></pre></div>
<p><img src="Spatial-R-for-Healthy-Places_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>The first bin doesn’t seem very intuitive. Let’s try 4 bins instead of 5 by changing the <code>n</code> parameter. In this version, we’ll also had a histogram and scale bar, and move the legend outside the frame to make it easier to view.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="02-choropleth.html#cb61-1" tabindex="-1"></a><span class="fu">tm_shape</span>(Chi_Zipsf) <span class="sc">+</span></span>
<span id="cb61-2"><a href="02-choropleth.html#cb61-2" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">&quot;Case.Rate...Cumulative&quot;</span>, </span>
<span id="cb61-3"><a href="02-choropleth.html#cb61-3" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>, <span class="at">pal=</span><span class="st">&quot;BuPu&quot;</span>,</span>
<span id="cb61-4"><a href="02-choropleth.html#cb61-4" tabindex="-1"></a>              <span class="at">legend.hist=</span>T, <span class="at">n=</span><span class="dv">4</span>,</span>
<span id="cb61-5"><a href="02-choropleth.html#cb61-5" tabindex="-1"></a>              <span class="at">title =</span> <span class="st">&quot;COVID Case Rate&quot;</span>, ) <span class="sc">+</span> </span>
<span id="cb61-6"><a href="02-choropleth.html#cb61-6" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="st">&quot;left&quot;</span>) </span></code></pre></div>
<p><img src="Spatial-R-for-Healthy-Places_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="integrate-more-data" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Integrate More Data<a href="02-choropleth.html#integrate-more-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To explore potential disparities in COVID health outcomes, let’s bring in pre-cleaned demographic, racial, and ethnic data from the <a href="https://geodacenter.github.io/opioid-policy-scan/">Opioid Environment Policy Scan database</a>. This data is orginally sourced from the American Community Survey 2018 5-year estimate, which you could also pull using the <code>tidycensus</code>.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="02-choropleth.html#cb62-1" tabindex="-1"></a>CensusVar <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/DS01_Z.csv&quot;</span>)</span>
<span id="cb62-2"><a href="02-choropleth.html#cb62-2" tabindex="-1"></a><span class="fu">head</span>(CensusVar)</span></code></pre></div>
<pre><code>##    ZCTA year totPopE whiteP blackP amIndP asianP pacIsP otherP  hispP  noHSP age0_4 age5_14 age15_19
## 1 35004 2018   11762  84.39  13.09   0.00   0.94   0.00   1.57   0.94   5.52    787    1950      457
## 2 35005 2018    7528  55.22  42.44   0.64   0.00   0.15   1.55   1.37  17.48    511    1055      455
## 3 35006 2018    2927  96.04   3.21   0.27   0.00   0.00   0.48   0.00  14.44    161     413      141
## 4 35007 2018   26328  73.83  13.75   0.04   1.33   0.02  11.01  11.11  12.41   1891    4161     1619
## 5 35010 2018   20625  63.07  32.43   0.39   0.65   0.00   3.45   4.10  22.00   1013    2647     1383
## 6 35013 2018      40 100.00   0.00   0.00   0.00   0.00   0.00 100.00 100.00      0       0        0
##   age20_24 age15_44 age45_49 age50_54 age55_59 age60_64 ageOv65 ageOv18 age18_64 a15_24P und45P ovr65P
## 1      746     4552      662      541      776      832    1662    8820     7158   10.23  61.97  14.13
## 2      277     2429      580      469      560      552    1372    5691     4319    9.72  53.07  18.23
## 3      203      878      129      193      316      278     559    2308     1749   11.75  49.61  19.10
## 4     1400     9947     1993     2067     1713     1315    3241   19178    15937   11.47  60.77  12.31
## 5     1087     7036     1418     1545     1510     1341    4115   16142    12027   11.98  51.86  19.95
## 6        0       13        8       19        0        0       0      40       40    0.00  32.50   0.00
##   disbP
## 1  12.7
## 2  23.2
## 3  20.9
## 4  13.5
## 5  19.6
## 6   0.0</code></pre>
<p>Merge to our master Zip Code dataset. There are many more zip codes than we have in our Chicago dataset, so we only keep the zip codes in the main dataset, Chi_Zipf. In this case, let’s test the merge to see if we retain 61 observations.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="02-choropleth.html#cb64-1" tabindex="-1"></a>Chi_Zips_test <span class="ot">&lt;-</span> <span class="fu">merge</span>(Chi_Zipsf, CensusVar, <span class="at">by.x =</span> <span class="st">&quot;zip&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;ZCTA&quot;</span>, <span class="at">all.x=</span><span class="cn">TRUE</span>)</span>
<span id="cb64-2"><a href="02-choropleth.html#cb64-2" tabindex="-1"></a></span>
<span id="cb64-3"><a href="02-choropleth.html#cb64-3" tabindex="-1"></a><span class="fu">dim</span>(Chi_Zips_test)</span></code></pre></div>
<pre><code>## [1] 62 32</code></pre>
</div>
<div id="thematic-map-panel" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Thematic Map Panel<a href="02-choropleth.html#thematic-map-panel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To facilitate data discovery, we likely want to explore multiple maps at once. Here we’ll generate maps for multiple variables, and plot them as a map panel.</p>
<p>Can you think of more efficient ways to run this code? There are also other <code>tmap</code> tricks to optimize this further, so enjoy your journey!</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="02-choropleth.html#cb66-1" tabindex="-1"></a>Chi_Zipsf <span class="ot">&lt;-</span> Chi_Zips_test</span>
<span id="cb66-2"><a href="02-choropleth.html#cb66-2" tabindex="-1"></a></span>
<span id="cb66-3"><a href="02-choropleth.html#cb66-3" tabindex="-1"></a> <span class="fu">tm_shape</span>(Chi_Zipsf) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;ovr65P&quot;</span>, </span>
<span id="cb66-4"><a href="02-choropleth.html#cb66-4" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>, <span class="at">pal=</span><span class="st">&quot;BuPu&quot;</span>, <span class="at">n=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="Spatial-R-for-Healthy-Places_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="02-choropleth.html#cb67-1" tabindex="-1"></a>COVID <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Chi_Zipsf) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;Case.Rate...Cumulative&quot;</span>, </span>
<span id="cb67-2"><a href="02-choropleth.html#cb67-2" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>, <span class="at">pal=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">n=</span><span class="dv">4</span>, <span class="at">title =</span> <span class="st">&quot;COVID Rt&quot;</span>) </span>
<span id="cb67-3"><a href="02-choropleth.html#cb67-3" tabindex="-1"></a></span>
<span id="cb67-4"><a href="02-choropleth.html#cb67-4" tabindex="-1"></a>Senior <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Chi_Zipsf) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;ovr65P&quot;</span>, </span>
<span id="cb67-5"><a href="02-choropleth.html#cb67-5" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>, <span class="at">pal=</span><span class="st">&quot;BuPu&quot;</span>, <span class="at">n=</span><span class="dv">4</span>) </span>
<span id="cb67-6"><a href="02-choropleth.html#cb67-6" tabindex="-1"></a></span>
<span id="cb67-7"><a href="02-choropleth.html#cb67-7" tabindex="-1"></a>NoHS <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Chi_Zipsf) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;noHSP&quot;</span>, </span>
<span id="cb67-8"><a href="02-choropleth.html#cb67-8" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>, <span class="at">pal=</span><span class="st">&quot;BuPu&quot;</span>, <span class="at">n=</span><span class="dv">4</span>)</span>
<span id="cb67-9"><a href="02-choropleth.html#cb67-9" tabindex="-1"></a></span>
<span id="cb67-10"><a href="02-choropleth.html#cb67-10" tabindex="-1"></a>BlkP <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Chi_Zipsf) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;blackP&quot;</span>, </span>
<span id="cb67-11"><a href="02-choropleth.html#cb67-11" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>, <span class="at">pal=</span><span class="st">&quot;BuPu&quot;</span>, <span class="at">n=</span><span class="dv">4</span>) </span>
<span id="cb67-12"><a href="02-choropleth.html#cb67-12" tabindex="-1"></a></span>
<span id="cb67-13"><a href="02-choropleth.html#cb67-13" tabindex="-1"></a>Latnx <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Chi_Zipsf) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;hispP&quot;</span>, </span>
<span id="cb67-14"><a href="02-choropleth.html#cb67-14" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>, <span class="at">pal=</span><span class="st">&quot;BuPu&quot;</span>, <span class="at">n=</span><span class="dv">4</span>, <span class="at">title=</span><span class="st">&quot;hispP&quot;</span>) </span>
<span id="cb67-15"><a href="02-choropleth.html#cb67-15" tabindex="-1"></a></span>
<span id="cb67-16"><a href="02-choropleth.html#cb67-16" tabindex="-1"></a>WhiP <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Chi_Zipsf) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">&quot;whiteP&quot;</span>, </span>
<span id="cb67-17"><a href="02-choropleth.html#cb67-17" tabindex="-1"></a>              <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>, <span class="at">pal=</span><span class="st">&quot;BuPu&quot;</span>, <span class="at">n=</span><span class="dv">4</span>) </span>
<span id="cb67-18"><a href="02-choropleth.html#cb67-18" tabindex="-1"></a></span>
<span id="cb67-19"><a href="02-choropleth.html#cb67-19" tabindex="-1"></a><span class="fu">tmap_arrange</span>(COVID, Senior, NoHS, BlkP, Latnx, WhiP)</span></code></pre></div>
<p><img src="Spatial-R-for-Healthy-Places_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>From the results, we see that cumulative COVID outcomes for one week in September 2020 seemed to have some geographic correlation with the Latinx/Hispanic community in Chicago. At the same time, low high school diploma rates are also concentrated in these areas, and there is some intersection with other variables considered. What are additional variables you could bring in to refine your approach? Perhaps percentage of essential workers; a different age group; internet access? What about linking in health outcomes like Asthma, Hypertension, and more at a similar scale?</p>
<p>In modern spatial epidemiology, associations must never be taken at face value. For example, we know that it is not “race” but “racism” that drives multiple health disparities – simply looking at a specific racial/ethnic group is not enough. Thus exploring multiple variables and nurturing a curiosity to understand these complex intersections will support knowledge discovery.</p>
</div>
<div id="data" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Data<a href="02-choropleth.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’re done! Well… not so fast. Let’s save the data so we don’t have to run the codebook again to access the data. Here, we’ll save as a <code>geojson</code> file. This spatial format is more forgiving with long column names, which is a long-standing challenge with shapefiles. But sometimes it can be written oddly, so double-check the dimensions when reading in later.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="02-choropleth.html#cb68-1" tabindex="-1"></a><span class="co">#st_write(Chi_Zipsf, &quot;data/ChiZipMaster.geojson&quot;, driver = &quot;GeoJSON&quot;)</span></span></code></pre></div>
<p>We could also just the data as a <code>CSV</code> file which may be easier for future linking. For this, we use the <code>st_drop_geometry()</code> function to remove the geometry data, so we’re just left with the attributes.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="02-choropleth.html#cb69-1" tabindex="-1"></a><span class="co">#write.csv(st_drop_geometry(Chi_Zipsf), &quot;data/ChiZipMaster.csv&quot;)</span></span></code></pre></div>
</div>
<div id="more-resources-1" class="section level2 unnumbered hasAnchor">
<h2>More Resources<a href="02-choropleth.html#more-resources-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For choropleth mapping in R:</p>
<ul>
<li><a href="https://spatialanalysis.github.io/lab_tutorials/4_R_Mapping.html" class="uri">https://spatialanalysis.github.io/lab_tutorials/4_R_Mapping.html</a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="01-intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="03-overlaypoints.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

</body>

</html>
